<!DOCTYPE html >
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p21" style="overflow: hidden; position: relative; background-color: white; width: 909px; height: 1286px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	-webkit-transform-origin: bottom left;
	-ms-transform-origin: bottom left;
	transform-origin: bottom left;
	-webkit-transform: scale(0.25);
	-ms-transform: scale(0.25);
	transform: scale(0.25);
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_21{left:271px;bottom:1100px;letter-spacing:-0.4px;word-spacing:8.4px;}
#t2_21{left:716px;bottom:1100px;}
#t3_21{left:183px;bottom:1068px;word-spacing:13px;}
#t4_21{left:239px;bottom:1068px;}
#t5_21{left:321px;bottom:1068px;word-spacing:13.2px;}
#t6_21{left:183px;bottom:1046px;letter-spacing:-0.1px;word-spacing:8.6px;}
#t7_21{left:355px;bottom:1046px;}
#t8_21{left:370px;bottom:1046px;letter-spacing:-0.1px;word-spacing:8.5px;}
#t9_21{left:584px;bottom:1046px;}
#ta_21{left:597px;bottom:1046px;word-spacing:8.3px;}
#tb_21{left:183px;bottom:1025px;letter-spacing:-0.1px;word-spacing:5.7px;}
#tc_21{left:455px;bottom:1025px;}
#td_21{left:467px;bottom:1025px;letter-spacing:0.2px;word-spacing:5.2px;}
#te_21{left:595px;bottom:1025px;}
#tf_21{left:604px;bottom:1025px;}
#tg_21{left:192px;bottom:990px;word-spacing:16.7px;}
#th_21{left:192px;bottom:973px;word-spacing:16.7px;}
#ti_21{left:192px;bottom:956px;word-spacing:16.7px;}
#tj_21{left:192px;bottom:939px;}
#tk_21{left:248px;bottom:939px;}
#tl_21{left:264px;bottom:939px;}
#tm_21{left:280px;bottom:939px;}
#tn_21{left:288px;bottom:939px;}
#to_21{left:344px;bottom:939px;}
#tp_21{left:360px;bottom:939px;}
#tq_21{left:376px;bottom:939px;}
#tr_21{left:392px;bottom:939px;}
#ts_21{left:408px;bottom:939px;}
#tt_21{left:424px;bottom:939px;}
#tu_21{left:440px;bottom:939px;}
#tv_21{left:456px;bottom:939px;}
#tw_21{left:192px;bottom:923px;word-spacing:16.7px;}
#tx_21{left:280px;bottom:923px;}
#ty_21{left:296px;bottom:923px;word-spacing:16.7px;}
#tz_21{left:192px;bottom:889px;word-spacing:16.7px;}
#t10_21{left:192px;bottom:872px;}
#t11_21{left:240px;bottom:872px;word-spacing:16.7px;}
#t12_21{left:192px;bottom:839px;word-spacing:16.7px;}
#t13_21{left:192px;bottom:822px;}
#t14_21{left:224px;bottom:822px;}
#t15_21{left:240px;bottom:822px;}
#t16_21{left:264px;bottom:822px;}
#t17_21{left:304px;bottom:822px;}
#t18_21{left:312px;bottom:822px;}
#t19_21{left:320px;bottom:822px;word-spacing:16.7px;}
#t1a_21{left:208px;bottom:805px;word-spacing:16.7px;}
#t1b_21{left:208px;bottom:789px;}
#t1c_21{left:240px;bottom:789px;}
#t1d_21{left:256px;bottom:789px;}
#t1e_21{left:208px;bottom:755px;word-spacing:16.7px;}
#t1f_21{left:208px;bottom:738px;}
#t1g_21{left:280px;bottom:738px;}
#t1h_21{left:296px;bottom:738px;}
#t1i_21{left:208px;bottom:722px;}
#t1j_21{left:280px;bottom:722px;letter-spacing:32px;}
#t1k_21{left:304px;bottom:722px;}
#t1l_21{left:320px;bottom:722px;}
#t1m_21{left:328px;bottom:722px;}
#t1n_21{left:208px;bottom:705px;word-spacing:16.7px;}
#t1o_21{left:208px;bottom:688px;}
#t1p_21{left:232px;bottom:688px;}
#t1q_21{left:304px;bottom:688px;word-spacing:16.7px;}
#t1r_21{left:336px;bottom:688px;}
#t1s_21{left:352px;bottom:688px;}
#t1t_21{left:360px;bottom:688px;}
#t1u_21{left:224px;bottom:671px;}
#t1v_21{left:296px;bottom:671px;}
#t1w_21{left:312px;bottom:671px;}
#t1x_21{left:208px;bottom:638px;word-spacing:16.7px;}
#t1y_21{left:208px;bottom:621px;}
#t1z_21{left:288px;bottom:621px;}
#t20_21{left:304px;bottom:621px;}
#t21_21{left:384px;bottom:621px;}
#t22_21{left:400px;bottom:621px;}
#t23_21{left:448px;bottom:621px;}
#t24_21{left:464px;bottom:621px;}
#t25_21{left:544px;bottom:621px;}
#t26_21{left:560px;bottom:621px;}
#t27_21{left:208px;bottom:605px;}
#t28_21{left:232px;bottom:605px;}
#t29_21{left:312px;bottom:605px;word-spacing:16.7px;}
#t2a_21{left:344px;bottom:605px;}
#t2b_21{left:224px;bottom:588px;}
#t2c_21{left:304px;bottom:588px;word-spacing:16.7px;}
#t2d_21{left:208px;bottom:554px;word-spacing:16.7px;}
#t2e_21{left:208px;bottom:538px;}
#t2f_21{left:232px;bottom:538px;}
#t2g_21{left:256px;bottom:538px;}
#t2h_21{left:264px;bottom:538px;}
#t2i_21{left:320px;bottom:538px;}
#t2j_21{left:344px;bottom:538px;}
#t2k_21{left:360px;bottom:538px;}
#t2l_21{left:368px;bottom:538px;}
#t2m_21{left:224px;bottom:521px;}
#t2n_21{left:280px;bottom:521px;}
#t2o_21{left:296px;bottom:521px;}
#t2p_21{left:224px;bottom:504px;}
#t2q_21{left:264px;bottom:504px;}
#t2r_21{left:280px;bottom:504px;}
#t2s_21{left:224px;bottom:487px;}
#t2t_21{left:264px;bottom:487px;}
#t2u_21{left:280px;bottom:487px;}
#t2v_21{left:200px;bottom:441px;letter-spacing:-0.1px;word-spacing:1.8px;}
#t2w_21{left:612px;bottom:441px;}
#t2x_21{left:620px;bottom:448px;}
#t2y_21{left:629px;bottom:441px;word-spacing:1.7px;}
#t2z_21{left:183px;bottom:420px;word-spacing:6.7px;}
#t30_21{left:629px;bottom:420px;}
#t31_21{left:637px;bottom:420px;word-spacing:9.8px;}
#t32_21{left:183px;bottom:398px;word-spacing:7px;}
#t33_21{left:183px;bottom:377px;letter-spacing:0.1px;word-spacing:5.4px;}
#t34_21{left:472px;bottom:377px;}
#t35_21{left:481px;bottom:377px;}
#t36_21{left:192px;bottom:342px;word-spacing:16.7px;}
#t37_21{left:192px;bottom:326px;}
#t38_21{left:264px;bottom:326px;}
#t39_21{left:280px;bottom:326px;}
#t3a_21{left:328px;bottom:326px;}
#t3b_21{left:344px;bottom:326px;}
#t3c_21{left:352px;bottom:326px;}
#t3d_21{left:360px;bottom:326px;}
#t3e_21{left:384px;bottom:326px;}
#t3f_21{left:392px;bottom:326px;}
#t3g_21{left:200px;bottom:279px;letter-spacing:0.1px;word-spacing:7.9px;}
#t3h_21{left:183px;bottom:258px;word-spacing:2.4px;}
#t3i_21{left:183px;bottom:237px;letter-spacing:-0.1px;word-spacing:10.1px;}

.s1_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMTI10_6;
	color: rgb(0,0,0);
}

.s2_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMR10_7;
	color: rgb(0,0,0);
}

.s3_21{
	FONT-SIZE: 66.7px;
	FONT-FAMILY: CMR10_7;
	color: rgb(0,0,0);
}

.s4_21{
	FONT-SIZE: 66.7px;
	FONT-FAMILY: CMTI10_6;
	color: rgb(0,0,0);
}

.s5_21{
	FONT-SIZE: 66.7px;
	FONT-FAMILY: CMMI10_1f;
	color: rgb(0,0,0);
}

.s6_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMITT10_68;
	color: rgb(64,128,128);
}

.s7_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMTT10_1b;
	color: rgb(0,0,0);
}

.s8_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMTT10_1b;
	color: rgb(102,102,102);
}

.s9_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMTT10_1b;
	color: rgb(0,128,0);
}

.s10_21{
	FONT-SIZE: 60.9px;
	FONT-FAMILY: CMTT10_1b;
	color: rgb(171,33,255);
}

.s11_21{
	FONT-SIZE: 48.7px;
	FONT-FAMILY: CMSY8_12;
	color: rgb(0,0,0);
}

.s12_21{
	FONT-SIZE: 66.7px;
	FONT-FAMILY: CMTT10_1b;
	color: rgb(0,0,0);
}

</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts21" type="text/css" >

@font-face {
	font-family: CMITT10_68;
	src: url("fonts/CMITT10_68.woff") format("woff");
}

@font-face {
	font-family: CMMI10_1f;
	src: url("fonts/CMMI10_1f.woff") format("woff");
}

@font-face {
	font-family: CMR10_7;
	src: url("fonts/CMR10_7.woff") format("woff");
}

@font-face {
	font-family: CMSY8_12;
	src: url("fonts/CMSY8_12.woff") format("woff");
}

@font-face {
	font-family: CMTI10_6;
	src: url("fonts/CMTI10_6.woff") format("woff");
}

@font-face {
	font-family: CMTT10_1b;
	src: url("fonts/CMTT10_1b.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg21Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg21" style="-webkit-user-select: none;"><object width="909" height="1286" data="21/21.svg" type="image/svg+xml" id="pdf21" style="width:909px; height:1286px; -moz-transform:scale(1); z-index: 0;"></object></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div id="t1_21" class="t s1_21">Bayesian inference and computation: a beginner’s guide</div>
<div id="t2_21" class="t s2_21">17</div>
<div id="t3_21" class="t s3_21">with a</div>
<div id="t4_21" class="t s4_21">symmetric</div>
<div id="t5_21" class="t s3_21">proposal distribution, where the probability of propos-</div>
<div id="t6_21" class="t s3_21">ing a move to position</div>
<div id="t7_21" class="t s5_21">a</div>
<div id="t8_21" class="t s3_21">given the current position is</div>
<div id="t9_21" class="t s5_21">b</div>
<div id="ta_21" class="t s3_21">is the same as the</div>
<div id="tb_21" class="t s3_21">probability of the reverse (proposing</div>
<div id="tc_21" class="t s5_21">b</div>
<div id="td_21" class="t s3_21">when at position</div>
<div id="te_21" class="t s5_21">a</div>
<div id="tf_21" class="t s3_21">).</div>
<div id="tg_21" class="t s6_21"># Generate a starting point (if you have a good guess, use it)</div>
<div id="th_21" class="t s6_21"># In the full version of the code, the initial point is drawn</div>
<div id="ti_21" class="t s6_21"># from the prior.</div>
<div id="tj_21" class="t s7_21">params</div>
<div id="tk_21" class="t s8_21">=</div>
<div id="tl_21" class="t s7_21">np</div>
<div id="tm_21" class="t s8_21">.</div>
<div id="tn_21" class="t s7_21">array([</div>
<div id="to_21" class="t s8_21">1.</div>
<div id="tp_21" class="t s7_21">,</div>
<div id="tq_21" class="t s8_21">1.</div>
<div id="tr_21" class="t s7_21">,</div>
<div id="ts_21" class="t s8_21">1.</div>
<div id="tt_21" class="t s7_21">,</div>
<div id="tu_21" class="t s8_21">1.</div>
<div id="tv_21" class="t s7_21">])</div>
<div id="tw_21" class="t s7_21">logp, logl</div>
<div id="tx_21" class="t s8_21">=</div>
<div id="ty_21" class="t s7_21">log_prior(params), log_likelihood(params)</div>
<div id="tz_21" class="t s6_21"># Total number of iterations</div>
<div id="t10_21" class="t s7_21">steps</div>
<div id="t11_21" class="t s8_21">= 100000</div>
<div id="t12_21" class="t s6_21"># Main loop</div>
<div id="t13_21" class="t s9_21">for</div>
<div id="t14_21" class="t s7_21">i</div>
<div id="t15_21" class="t s10_21">in</div>
<div id="t16_21" class="t s9_21">range</div>
<div id="t17_21" class="t s7_21">(</div>
<div id="t18_21" class="t s8_21">0</div>
<div id="t19_21" class="t s7_21">, steps):</div>
<div id="t1a_21" class="t s6_21"># Generate proposal</div>
<div id="t1b_21" class="t s7_21">new</div>
<div id="t1c_21" class="t s8_21">=</div>
<div id="t1d_21" class="t s7_21">proposal(params)</div>
<div id="t1e_21" class="t s6_21"># Evaluate prior and likelihood for the proposal</div>
<div id="t1f_21" class="t s7_21">logp_new</div>
<div id="t1g_21" class="t s8_21">=</div>
<div id="t1h_21" class="t s7_21">log_prior(new)</div>
<div id="t1i_21" class="t s7_21">logl_new</div>
<div id="t1j_21" class="t s8_21">=-</div>
<div id="t1k_21" class="t s7_21">np</div>
<div id="t1l_21" class="t s8_21">.</div>
<div id="t1m_21" class="t s7_21">Inf</div>
<div id="t1n_21" class="t s6_21"># Only evaluate likelihood if prior prob isn't zero</div>
<div id="t1o_21" class="t s9_21">if</div>
<div id="t1p_21" class="t s7_21">logp_new</div>
<div id="t1q_21" class="t s8_21">!= -</div>
<div id="t1r_21" class="t s7_21">np</div>
<div id="t1s_21" class="t s8_21">.</div>
<div id="t1t_21" class="t s7_21">Inf:</div>
<div id="t1u_21" class="t s7_21">logl_new</div>
<div id="t1v_21" class="t s8_21">=</div>
<div id="t1w_21" class="t s7_21">log_likelihood(new)</div>
<div id="t1x_21" class="t s6_21"># Acceptance probability</div>
<div id="t1y_21" class="t s7_21">log_alpha</div>
<div id="t1z_21" class="t s8_21">=</div>
<div id="t20_21" class="t s7_21">(logl_new</div>
<div id="t21_21" class="t s8_21">-</div>
<div id="t22_21" class="t s7_21">logl)</div>
<div id="t23_21" class="t s8_21">+</div>
<div id="t24_21" class="t s7_21">(logp_new</div>
<div id="t25_21" class="t s8_21">-</div>
<div id="t26_21" class="t s7_21">logp)</div>
<div id="t27_21" class="t s9_21">if</div>
<div id="t28_21" class="t s7_21">log_alpha</div>
<div id="t29_21" class="t s8_21">&gt; 0.</div>
<div id="t2a_21" class="t s7_21">:</div>
<div id="t2b_21" class="t s7_21">log_alpha</div>
<div id="t2c_21" class="t s8_21">= 0.</div>
<div id="t2d_21" class="t s6_21"># Accept?</div>
<div id="t2e_21" class="t s9_21">if</div>
<div id="t2f_21" class="t s7_21">rng</div>
<div id="t2g_21" class="t s8_21">.</div>
<div id="t2h_21" class="t s7_21">rand()</div>
<div id="t2i_21" class="t s8_21">&lt;=</div>
<div id="t2j_21" class="t s7_21">np</div>
<div id="t2k_21" class="t s8_21">.</div>
<div id="t2l_21" class="t s7_21">exp(log_alpha):</div>
<div id="t2m_21" class="t s7_21">params</div>
<div id="t2n_21" class="t s8_21">=</div>
<div id="t2o_21" class="t s7_21">new</div>
<div id="t2p_21" class="t s7_21">logp</div>
<div id="t2q_21" class="t s8_21">=</div>
<div id="t2r_21" class="t s7_21">logp_new</div>
<div id="t2s_21" class="t s7_21">logl</div>
<div id="t2t_21" class="t s8_21">=</div>
<div id="t2u_21" class="t s7_21">logl_new</div>
<div id="t2v_21" class="t s3_21">The “random walk” proposal generates a proposed value</div>
<div id="t2w_21" class="t s5_21">θ</div>
<div id="t2x_21" class="t s11_21">0</div>
<div id="t2y_21" class="t s3_21">from a normal</div>
<div id="t2z_21" class="t s3_21">(gaussian) distribution centered around the current position</div>
<div id="t30_21" class="t s5_21">θ</div>
<div id="t31_21" class="t s3_21">. The user is</div>
<div id="t32_21" class="t s3_21">free to choose the width of the normal distribution. Here is a Python code</div>
<div id="t33_21" class="t s3_21">snippet showing a proposal with width</div>
<div id="t34_21" class="t s12_21">L</div>
<div id="t35_21" class="t s3_21">:</div>
<div id="t36_21" class="t s6_21"># Generate a proposal</div>
<div id="t37_21" class="t s7_21">proposal</div>
<div id="t38_21" class="t s8_21">=</div>
<div id="t39_21" class="t s7_21">theta</div>
<div id="t3a_21" class="t s8_21">+</div>
<div id="t3b_21" class="t s7_21">L</div>
<div id="t3c_21" class="t s8_21">*</div>
<div id="t3d_21" class="t s7_21">rng</div>
<div id="t3e_21" class="t s8_21">.</div>
<div id="t3f_21" class="t s7_21">randn()</div>
<div id="t3g_21" class="t s3_21">The performance of the Metropolis algorithm depends quite strongly on</div>
<div id="t3h_21" class="t s3_21">the width of the proposal distribution. If the width is too small, most moves</div>
<div id="t3i_21" class="t s3_21">will be accepted, but won’t move very far. If the width is too large, most</div>

<!-- End text definitions -->


</div>
</body>
</html>
